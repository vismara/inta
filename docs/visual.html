<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Edgar Vismara and Frederico Vieira">
<title>Analysis of the behavior of dairy cattle using R - 5&nbsp; Data visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./linear.html" rel="next">
<link href="./manip.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Introduction to R</a></li><li class="breadcrumb-item"><a href="./visual.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data visualization</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analysis of the behavior of dairy cattle using R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./start.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manip.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visual.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data visualization</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Statistical Modeling of Dairy Cattle Behavior</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Basic linear model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Beyond the Gaussian linear models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">GLM models framework</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#ggplot2-grammar" id="toc-ggplot2-grammar" class="nav-link active" data-scroll-target="#ggplot2-grammar"><span class="header-section-number">5.1</span> <code>ggplot2</code> grammar</a>
  <ul class="collapse">
<li><a href="#basic-elements" id="toc-basic-elements" class="nav-link" data-scroll-target="#basic-elements"><span class="header-section-number">5.1.1</span> Basic elements</a></li>
  </ul>
</li>
  <li><a href="#exploring-geometries" id="toc-exploring-geometries" class="nav-link" data-scroll-target="#exploring-geometries"><span class="header-section-number">5.2</span> Exploring Geometries</a></li>
  <li><a href="#faceting-for-complex-data" id="toc-faceting-for-complex-data" class="nav-link" data-scroll-target="#faceting-for-complex-data"><span class="header-section-number">5.3</span> Faceting for Complex Data</a></li>
  <li>
<a href="#configuring-aesthetics" id="toc-configuring-aesthetics" class="nav-link" data-scroll-target="#configuring-aesthetics"><span class="header-section-number">5.4</span> Configuring aesthetics</a>
  <ul class="collapse">
<li><a href="#colour" id="toc-colour" class="nav-link" data-scroll-target="#colour"><span class="header-section-number">5.4.1</span> Colour</a></li>
  <li><a href="#shape-size-and-alpha" id="toc-shape-size-and-alpha" class="nav-link" data-scroll-target="#shape-size-and-alpha"><span class="header-section-number">5.4.2</span> Shape Size and alpha</a></li>
  </ul>
</li>
  <li>
<a href="#configuring-themes" id="toc-configuring-themes" class="nav-link" data-scroll-target="#configuring-themes"><span class="header-section-number">5.5</span> Configuring themes</a>
  <ul class="collapse">
<li><a href="#default-theme" id="toc-default-theme" class="nav-link" data-scroll-target="#default-theme"><span class="header-section-number">5.5.1</span> Default theme</a></li>
  <li><a href="#classic-theme" id="toc-classic-theme" class="nav-link" data-scroll-target="#classic-theme"><span class="header-section-number">5.5.2</span> Classic theme</a></li>
  <li><a href="#theme-minimal" id="toc-theme-minimal" class="nav-link" data-scroll-target="#theme-minimal"><span class="header-section-number">5.5.3</span> Theme minimal</a></li>
  <li><a href="#theme-dark" id="toc-theme-dark" class="nav-link" data-scroll-target="#theme-dark"><span class="header-section-number">5.5.4</span> Theme dark</a></li>
  </ul>
</li>
  <li><a href="#arrange-plots" id="toc-arrange-plots" class="nav-link" data-scroll-target="#arrange-plots"><span class="header-section-number">5.6</span> Arrange plots</a></li>
  <li><a href="#other-plots" id="toc-other-plots" class="nav-link" data-scroll-target="#other-plots"><span class="header-section-number">5.7</span> Other plots</a></li>
  <li><a href="#saving-plots" id="toc-saving-plots" class="nav-link" data-scroll-target="#saving-plots"><span class="header-section-number">5.8</span> Saving plots</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data visualization</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In the previous section, we showed a basic line plot using the <code>ggplot2</code> package in R. We visualized the ratio of American Cheese to Mozzarella consumption over the years with a simple line and point plot. Here’s the code for the previous plot:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">merged_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Ratio (American Cheese / Mozzarella)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Ratio of American Cheese to Mozzarella Consumption Over the Years"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The power of data visualization is crucial in the field of data analysis and exploration. It allows us to gain insights from data, identify patterns, and convey complex information in an understandable manner. <code>ggplot2</code>, a popular data visualization package in R, is a versatile and powerful tool for creating a wide range of plots and graphs.</p>
<p>What sets <code>ggplot2</code> apart is its unique layering system, which allows you to add different components to a plot in a structured and modular way. Layers enable us to build complex and informative visualizations by adding various elements to our plots, such as multiple data series, labels, titles, and more.</p>
<p>As an example, we can present the earlier plot in the following manner:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">merged_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>              formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>              se <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Ratio (American Cheese / Mozzarella)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Ratio of American Cheese to Mozzarella Consumption Over the Years"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Plot with Regression Lines"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data source: GitHub"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here’s a quick breakdown of previous code:</p>
<ol type="1">
<li>
<strong>Data and Aesthetics (ggplot)</strong>:
<ul>
<li>We start with the <code>ggplot</code> function, specifying the dataset <code>merged_data</code> and aesthetic mappings. The x-axis represents the “year,” and the y-axis represents the “ratio.”</li>
</ul>
</li>
<li>
<strong>Scatterplot (geom_point)</strong>:
<ul>
<li>The <code>geom_point</code> layer is added to create a scatterplot of data points. Each point represents a data entry.</li>
<li>The <code>size</code> parameter is set to 2, making the points larger for better visibility.</li>
</ul>
</li>
<li>
<strong>Line Plot (geom_line)</strong>:
<ul>
<li>The <code>geom_line</code> layer is used to create a line plot. This line connects the data points in chronological order, providing a visual representation of the trend.</li>
<li>The <code>color</code> parameter is set to “blue,” and the <code>linewidth</code> parameter is set to 1 to customize the color and thickness of the line.</li>
</ul>
</li>
<li>
<strong>Regression Line (geom_smooth)</strong>:
<ul>
<li>We’ve added a regression line to the plot using the <code>geom_smooth</code> layer.</li>
<li>The <code>method</code> is set to <code>lm</code> (linear model), indicating a linear regression model.</li>
<li>The <code>formula</code> argument specifies a polynomial regression model (<code>y ~ poly(x, 2)</code>) of degree 2.</li>
<li>The <code>se</code> parameter is set to <code>TRUE</code>, which adds confidence intervals around the regression line, giving an indication of the uncertainty.</li>
<li>The <code>color</code> parameter is set to “red” to make the regression line visually distinct.</li>
</ul>
</li>
<li>
<strong>Labels (labs)</strong>:
<ul>
<li>The <code>labs</code> function is used to add labels and titles to the plot. It provides clarity and context to the visualization.</li>
<li>The x-axis label is “Year”, the y-axis label is “Ratio (American Cheese / Mozzarella)”, the main title is “Ratio of American Cheese to Mozzarella Consumption Over the Years”, the subtitle specifies that this is a plot with regression lines, and the caption attributes the data source to “GitHub”.</li>
</ul>
</li>
<li>
<strong>Theme (theme_minimal)</strong>:
<ul>
<li>Finally, the <code>theme_minimal()</code> function is applied to give the plot a clean and uncluttered appearance. This minimal theme provides a simple background, allowing the data and plot elements to take center stage.</li>
</ul>
</li>
</ol>
<hr>
<section id="ggplot2-grammar" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="ggplot2-grammar">
<span class="header-section-number">5.1</span> <code>ggplot2</code> grammar</h2>
<p><code>ggplot2</code>, is built on the foundation of the “Grammar of Graphics.” This framework allows you to create intricate and customized plots by layering (<a href="#fig-layers">Figure&nbsp;<span>5.1</span></a>) different geometric shapes and elements. Understanding the concept of geometry and layering is essential for informative visualizations.</p>
<div id="fig-layers" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/image-layers.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5.1: Source: Quebec Centre for Biodiversity Science (2022), Chapter 5 in Workshop 3: Introduction to Data Visualization. <a href="https://r.qcbs.ca/workshop03/book-en/grammar-of-graphics-gg-basics.html">source.</a></figcaption></figure>
</div>
<p>Below, we present a breakdown of different elements and common parameters for each within the Grammar of Graphics framework:</p>
<section id="basic-elements" class="level3" data-number="5.1.1"><h3 data-number="5.1.1" class="anchored" data-anchor-id="basic-elements">
<span class="header-section-number">5.1.1</span> Basic elements</h3>
<p><strong>Data</strong>: This refers to your dataset, organized in a tidy format, and serves as the foundation for your plot. You can utilize dplyr techniques to prepare the data for optimal plotting, usually requiring one row for each observation you intend to visualize.</p>
<p><strong>Aesthetics (aes)</strong>: Aesthetics are parameters that make the data visually meaningful. Here are some common aesthetics:</p>
<ul>
<li>
<strong>x, y</strong>: Represent variables along the x and y axes, respectively.</li>
<li>
<strong>colour</strong>: Dictates the color of the graphic elements based on data.</li>
<li>
<strong>fill</strong>: Specifies the interior color of the graphical element.</li>
<li>
<strong>group</strong>: Defines the group to which a graphical element belongs.</li>
<li>
<strong>shape</strong>: Determines the figure used for plotting a point.</li>
<li>
<strong>linetype</strong>: Specifies the type of line to be used (e.g., solid, dashed).</li>
<li>
<strong>size</strong>: Controls the size of elements to represent an additional dimension.</li>
<li>
<strong>alpha</strong>: Governs the transparency level of the graphical element.</li>
</ul>
<p><strong>Geometric Objects (geoms)</strong>: Geoms determine the type of plot to create. Here are some common geoms:</p>
<ul>
<li>
<strong>geom_point()</strong>: Used for scatterplots.</li>
<li>
<strong>geom_line()</strong>: Connects points in increasing order of x values.</li>
<li>
<strong>geom_path()</strong>: Connects points in the sequence of appearance.</li>
<li>
<strong>geom_boxplot()</strong>: Generates box and whisker plots for categorical variables.</li>
<li>
<strong>geom_bar()</strong>: Creates bar charts, typically used for categorical x-axes.</li>
<li>
<strong>geom_histogram()</strong>: Produces histograms, commonly for continuous x-axes.</li>
<li>
<strong>geom_violin()</strong>: Represents the kernel of data dispersion in a distribution.</li>
<li>
<strong>geom_smooth()</strong>: Generates a function line based on data.</li>
</ul>
<p><strong>Facets</strong>: Faceting helps create small multiples, allowing you to visualize subsets of your data. You can use <code>facet_wrap()</code> or <code>facet_grid()</code> for this purpose.</p>
<p><strong>Statistics</strong>: Statistics are similar to geoms, but they are computed values that summarize your data. They can show means, counts, and other statistical summaries.</p>
<p><strong>Coordinates</strong>: Coordinates determine how data is mapped onto the plot. Here are some coordinate options:</p>
<ul>
<li>
<code>coord_cartesian</code>: Sets limits for the plot.</li>
<li>
<code>coord_polar</code>: Used for circular plots.</li>
<li>
<code>coord_map</code>: Applied for various map projections.</li>
</ul>
<p><strong>Themes</strong>: Themes define the overall visual defaults for your plot. You can use themes to specify fonts, colors, shapes, and outlines to achieve a consistent visual style.</p>
<p>Next, we will demonstrate the layering grammar of ggplot2. On this example we will learn how to create a scatterplot with <code>ggplot2</code> and add layers, geometries, and configurations step by step using simulated dairy cattle production data.</p>
<p><strong>Step 1: Inserting data and Aesthetics</strong></p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulated dairy cattle production data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">cattle_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Year <span class="op">=</span> <span class="fl">2000</span><span class="op">:</span><span class="fl">2020</span>,</span>
<span>  Milk_Production <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">21</span>, min <span class="op">=</span> <span class="fl">8000</span>, max <span class="op">=</span> <span class="fl">12000</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Cheese_Production <span class="op">=</span> <span class="op">(</span><span class="va">Milk_Production</span> <span class="op">*</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a ggplot object with data and aesthetics</span></span>
<span><span class="va">scatter_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scatter_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Step 2: Adding the Scatterplot (points) Geometry</strong></p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add the scatterplot geometry using geom_point</span></span>
<span><span class="va">scatter_plot</span> <span class="op">&lt;-</span> <span class="va">scatter_plot</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">scatter_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Step 3: Adding Labels and Title</strong></p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add labels and a title</span></span>
<span><span class="va">scatter_plot</span> <span class="op">&lt;-</span> <span class="va">scatter_plot</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Millions of Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Millions of Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">scatter_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Step 4: Applying a Minimal Theme</strong></p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Apply a minimal theme</span></span>
<span><span class="va">scatter_plot</span> <span class="op">&lt;-</span> <span class="va">scatter_plot</span> <span class="op">+</span> <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the scatter plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">scatter_plot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="exploring-geometries" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="exploring-geometries">
<span class="header-section-number">5.2</span> Exploring Geometries</h2>
<p>In this instance, we will present different geometric shapes and their application in ggplot2 visualizations.</p>
<p><strong>Example (Simple Line Plot)</strong></p>
<p>In ggplot2, a line plot is often utilized in conjunction with a scatterplot, as they are frequently applied to the same dataset and serve the same visualization purpose. It is not uncommon for both types of plots to be used together.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a ggplot object for a scatterplot and line plot</span></span>
<span><span class="va">line_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Scatterplot (points)</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>   <span class="co"># Line plot</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Millions of Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Millions of Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">line_plot</span>  <span class="co"># Display the combined plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This type of plot is commonly employed to visualize and describe time series data, particularly in the context of climate and environmental data over time.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a sample time series dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">date_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-01"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"1 month"</span><span class="op">)</span></span>
<span><span class="va">temperature_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Date <span class="op">=</span> <span class="va">date_range</span>,</span>
<span>  Temperature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">date_range</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a time series plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">temperature_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">Temperature</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Temperature (°C)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Monthly Temperature Time Series"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Example (Histogram)</strong></p>
<p>Histograms are a commonly employed data visualization tool to illustrate the frequency distribution of a specific variable. To illustrate this, we will use the “state_milk_production” dataset, filtering it for a particular year (as it is not meaningful to examine the distribution of a variable measured over multiple years).</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Filter the dataset for a specific year and select the 'milk_produced' column</span></span>
<span><span class="va">year_to_analyze</span> <span class="op">&lt;-</span> <span class="fl">1980</span></span>
<span><span class="va">filtered_data</span> <span class="op">&lt;-</span> <span class="va">state_milk_production</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="va">year_to_analyze</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">milk_produced</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a histogram</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">filtered_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">milk_produced</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">8</span>, boundary<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Milk Production Distribution for the Year"</span>, <span class="va">year_to_analyze</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Example (Bar Plot)</strong></p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Filter data to focus on the top 5 states with the highest milk production</span></span>
<span><span class="va">top_states</span> <span class="op">&lt;-</span> <span class="va">state_milk_production</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>avg_Milk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">milk_produced</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">avg_Milk</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a bar plot to compare milk production in the top 5 states</span></span>
<span><span class="va">bar_plot_top_states</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">top_states</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">state</span>, <span class="op">-</span><span class="va">avg_Milk</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">avg_Milk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"State"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Average Milk Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Top 5 States with Highest Milk Production"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the bar plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">bar_plot_top_states</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Example (Scatter Plot with linear fit)</strong></p>
<p>Expanding upon a dataset that includes data on milk and cheese production in various states and regions, we move beyond the confines of a basic linear plot. By introducing trendlines, we empower ourselves to delve deeper into the intricacies of the relationships between these variables.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a linear plot with trendlines</span></span>
<span><span class="va">linear_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Scatterplot points</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Linear trendlines</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Millions of Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Millions of Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Linear Relationship Between Milk and Cheese Production"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">linear_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Example (Boxplot and Violin plot)</strong></p>
<p>Similar to histograms, boxplots serve the purpose of visualizing data distributions. However, they are commonly employed when the goal is to compare these distributions among different groups.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Filter the data to include only New York and California</span></span>
<span><span class="va">df_groups</span> <span class="op">&lt;-</span> <span class="va">state_milk_production</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"New York"</span>, <span class="st">"California"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Boxplot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_groups</span>, </span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">state</span>, </span>
<span>           y <span class="op">=</span> <span class="va">milk_produced</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Create a boxplot</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Boxplot"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add a title</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Apply a minimal theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Violin plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_groups</span>, </span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">state</span>, </span>
<span>           y <span class="op">=</span> <span class="va">milk_produced</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Create a violin plot</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Violin Plot"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add a title</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Apply a minimal theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Example (Representing maps)</strong></p>
<p>Maps play a fundamental role in data visualization by providing a spatial context that aids in revealing patterns, relationships, and trends in various data sets, such as demographics, environmental factors, and resource distribution.</p>
<p>In this context, we will explore the spatial distribution of milk production across the United States.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a new dataframe 'df' based on the 'state_milk_production' dataset</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">state_milk_production</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Group the data by 'state'</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Calculate the average milk production for each state</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>avg_milk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">milk_produced</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># load maps library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">maps</span>, <span class="va">mapproj</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'maps'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    map</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">states_map</span> <span class="op">&lt;-</span> <span class="fu">map_data</span><span class="op">(</span><span class="st">"state"</span><span class="op">)</span> <span class="co"># get a state-level map of the US</span></span>
<span></span>
<span><span class="co"># Let's make a new column for the states name</span></span>
<span><span class="co"># that matches the column of state names in our states_map</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build our map</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, </span>
<span>       <span class="fu">aes</span><span class="op">(</span>map_id <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># the variable name to link our map and dataframe</span></span>
<span>  <span class="fu">geom_map</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">avg_milk</span><span class="op">)</span>, <span class="co"># variable we want to represent with an aesthetic</span></span>
<span>           map <span class="op">=</span> <span class="va">states_map</span><span class="op">)</span> <span class="op">+</span> <span class="co"># data frame that contains coordinates</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>x <span class="op">=</span> <span class="va">states_map</span><span class="op">$</span><span class="va">long</span>, </span>
<span>                y <span class="op">=</span> <span class="va">states_map</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_map</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># projection </span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="co"># remove axis labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="faceting-for-complex-data" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="faceting-for-complex-data">
<span class="header-section-number">5.3</span> Faceting for Complex Data</h2>
<p>Facetting in ggplot2 is a powerful technique that allows you to create multiple small plots, or facets, within a single visualization. Each facet typically represents a subset of your data, making it an effective way to compare and visualize multiple aspects of your dataset simultaneously. In this example, we will explore faceting in ggplot2 and demonstrate its utility through two different scenarios.</p>
<p><strong>Example 1:</strong></p>
<p>In the first example, we’ll use faceting to create a bar plot that shows the average milk production in the states of New York and California over the years 2010 to 2014. This will help us visualize how milk production varies in these two states during this time period.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_2</span> <span class="op">&lt;-</span> <span class="va">state_milk_production</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"New York"</span>, <span class="st">"California"</span><span class="op">)</span>, <span class="fu">between</span><span class="op">(</span><span class="va">year</span>, <span class="fl">2010</span>, <span class="fl">2014</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">state</span>, <span class="va">year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>avg_milk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">milk_produced</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'state'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a faceted bar plot for milk production by state</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">state</span>, y <span class="op">=</span> <span class="va">avg_milk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">year</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Facet by year with one row</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"State"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Faceted Bar Plot of Milk Production by Year"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Example 2:</strong></p>
<p>In the second example, we’ll use facetting to create a scatterplot to compare the relationship between milk and cheese production for different regions. This will allow us to visually explore how these two variables are related in two different states.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set the random seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a dataframe for cattle data with two states</span></span>
<span><span class="va">cattle_data_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Year <span class="op">=</span> <span class="fl">2000</span><span class="op">:</span><span class="fl">2021</span>,</span>
<span>  State <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"California"</span>, <span class="st">"New York"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,  <span class="co"># Assign two states alternately</span></span>
<span>  Milk_Production <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">22</span>, min <span class="op">=</span> <span class="fl">8000</span>, max <span class="op">=</span> <span class="fl">12000</span><span class="op">)</span>  <span class="co"># Simulate milk production</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">mutate</span><span class="op">(</span></span>
<span>  Cheese_Production <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">State</span> <span class="op">==</span> <span class="st">"California"</span> <span class="op">~</span> <span class="op">(</span><span class="va">Milk_Production</span> <span class="op">*</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>    <span class="va">State</span> <span class="op">==</span> <span class="st">"New York"</span> <span class="op">~</span> <span class="op">(</span><span class="va">Milk_Production</span> <span class="op">*</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">22</span>, <span class="fl">0</span>, <span class="fl">80</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a faceted scatterplot with cattle data for milk vs. cheese production by region</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">State</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Facet by region with 2 columns</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Faceted Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="configuring-aesthetics" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="configuring-aesthetics">
<span class="header-section-number">5.4</span> Configuring aesthetics</h2>
<p>Now, let’s explore the fundamental aspects of the aesthetic layer in data visualization. Aesthetics, as specified with <code>aes()</code> in <code>ggplot2</code>, enable us to distinguish between classes, groups, and data structures effectively.</p>
<p>In this section, we will examine key aesthetic properties, such as color, shape, size, labels, and transparency. These attributes function as essential tools for tailoring your visualizations to specific requirements, allowing you to craft informative, customizable plots that faithfully represent your data’s insights.</p>
<hr>
<section id="colour" class="level3" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="colour">
<span class="header-section-number">5.4.1</span> Colour</h3>
<p><strong>1. Groups (discrete variables)</strong></p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>2. Gradients (continous variables)</strong></p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">Milk_Production</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>2. Manual colors</strong></p>
<p><strong>Discrete variables</strong></p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orange"</span>,<span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Gradient</strong></p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">Milk_Production</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"gray85"</span>, high <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr></section><section id="shape-size-and-alpha" class="level3" data-number="5.4.2"><h3 data-number="5.4.2" class="anchored" data-anchor-id="shape-size-and-alpha">
<span class="header-section-number">5.4.2</span> Shape Size and alpha</h3>
<p>Let’s move past colors for a moment. If we want to change how our data points look, we can use different shapes for different groups by specifying the “shape” parameter within the “aes()” layer. This is similar to what we did with colors. For instance, we can use the “species” variable to group our data points by shape.</p>
<p>If we’d like to control the size of the data points, we can use the “size” parameter in the same way. And if we want to make data points more or less transparent, we can use the “alpha” parameter. Both of these options work well when dealing with continuous data.</p>
<p><strong>Shape for discrete variables</strong></p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, shape <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, linetype <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Size and Alpha for continous</strong></p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, size <span class="op">=</span> <span class="va">Milk_Production</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>alpha</strong></p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, alpha <span class="op">=</span> <span class="va">Milk_Production</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Legends</strong></p>
</section></section><section id="configuring-themes" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="configuring-themes">
<span class="header-section-number">5.5</span> Configuring themes</h2>
<p>Throughout this turorial, the plots have consistently utilized the “theme_classic()” setting. This choice was made because the default gray background can sometimes make certain colors less distinct and harder to discern.</p>
<p>The <code>ggplot2</code> package boasts an extensive array of theme elements, far too numerous to cover comprehensively here.</p>
<p>Rather than exploring the multitude of attributes contained within the “theme()” function <a href="#fig-elephant">Figure&nbsp;<span>5.2</span></a>, you can initiate your theming journey with theme functions. These theme functions come equipped with a predefined set of elements to begin with. Below, you’ll find some illustrative examples:</p>
<div id="fig-elephant" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/ggplot2-theme-elements-reference-v2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5.2: ggplot2 theme reference sheet by Isabella Benabaye <a href="https://isabella-b.com/blog/ggplot2-theme-elements-reference/">source.</a></figcaption></figure>
</div>
<section id="default-theme" class="level3" data-number="5.5.1"><h3 data-number="5.5.1" class="anchored" data-anchor-id="default-theme">
<span class="header-section-number">5.5.1</span> Default theme</h3>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span><span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="co">#theme_gray()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="classic-theme" class="level3" data-number="5.5.2"><h3 data-number="5.5.2" class="anchored" data-anchor-id="classic-theme">
<span class="header-section-number">5.5.2</span> Classic theme</h3>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="theme-minimal" class="level3" data-number="5.5.3"><h3 data-number="5.5.3" class="anchored" data-anchor-id="theme-minimal">
<span class="header-section-number">5.5.3</span> Theme minimal</h3>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="theme-dark" class="level3" data-number="5.5.4"><h3 data-number="5.5.4" class="anchored" data-anchor-id="theme-dark">
<span class="header-section-number">5.5.4</span> Theme dark</h3>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_dark</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A compelling choice is to establish a consistent theme that spans your entire analysis. For this, we can use the <code>set_theme()</code> option:</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Using the properties detalied in <a href="#fig-elephant">Figure&nbsp;<span>5.2</span></a> you can also set your own theme:</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mytheme</span> <span class="op">&lt;-</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>           <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span> <span class="va">mytheme</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>While ggplot2 offers a set of default themes that are functional and clean, you can expand your design possibilities by integrating the “ggthemes” library. This additional library introduces an array of new themes that cater to specific needs and preferences, from classic and minimalistic to vibrant and distinctive.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#install.packages("ggthemes")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## excel theme</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_excel.html">theme_excel</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## tufte theme</span></span>
<span><span class="va">p_tufte</span> <span class="op">=</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">cattle_data_2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Milk_Production</span>, y <span class="op">=</span> <span class="va">Cheese_Production</span>, col <span class="op">=</span> <span class="va">State</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Milk Production (Pounds)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cheese Production (Pounds)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of Milk vs. Cheese Production by Region"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_fivethirtyeight.html">theme_fivethirtyeight</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_tufte</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="arrange-plots" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="arrange-plots">
<span class="header-section-number">5.6</span> Arrange plots</h2>
<p>Sometimes is useful to combine one or more plots in one image. R provide several options to do this.</p>
<p><strong>1. Using <code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange()</a></code></strong></p>
<p><code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange()</a></code> is a part of the <code>gridExtra</code> package and allows you to arrange multiple ggplot2 plots into a grid layout.</p>
<p>First, make sure you have the <code>gridExtra</code> package installed. You can install it with <code>install.packages("gridExtra")</code>.</p>
<p>Here’s how to use <code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange()</a></code> with examples:</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create some sample plots</span></span>
<span><span class="va">plot1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="va">disp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hp</span>, y <span class="op">=</span> <span class="va">wt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Arrange the plots into a 2x1 grid</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">plot1</span>, <span class="va">plot2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>2. Using <code>patchwork</code></strong></p>
<p><code>patchwork</code> is a popular package for arranging ggplot2 plots. It allows you to create complex layouts by combining and arranging plots.</p>
<p>You can install the <code>patchwork</code> package with <code>install.packages("patchwork")</code>.</p>
<p>Here’s how to use <code>patchwork</code> with examples:</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="co"># Combine the plots horizontally using the `+` operator</span></span>
<span><span class="va">combined_plots</span> <span class="op">&lt;-</span> <span class="va">plot1</span> <span class="op">+</span> <span class="va">plot2</span></span>
<span><span class="va">combined_plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>3. Using <code>|</code> for Simpler Vertical Arrangement</strong></p>
<p>You can also arrange ggplot2 plots vertically using the <code>|</code> operator, making it simple and effective.</p>
<p>Here’s how to use <code>|</code> with examples:</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Arrange the plots vertically using the | operator</span></span>
<span><span class="va">combined_plots</span> <span class="op">&lt;-</span> <span class="va">plot1</span> <span class="op">|</span> <span class="va">plot2</span></span>
<span><span class="va">combined_plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="visual_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this tutorial, we’ve covered three methods to arrange ggplot2 plots. You can choose the one that best suits your needs and preferences. These techniques will help you effectively display and compare multiple plots in your data visualization projects.</p>
</section><section id="other-plots" class="level2" data-number="5.7"><h2 data-number="5.7" class="anchored" data-anchor-id="other-plots">
<span class="header-section-number">5.7</span> Other plots</h2>
<p><strong>Pie Chart</strong></p>
<p><strong>Dendrogram</strong></p>
</section><section id="saving-plots" class="level2" data-number="5.8"><h2 data-number="5.8" class="anchored" data-anchor-id="saving-plots">
<span class="header-section-number">5.8</span> Saving plots</h2>
<p>To save a plot, we can employ the <code>ggsave</code> function. Within this function, you specify the desired filename, including the file format extension (e.g., “plot.png”). Next, you provide the name of the plot object in R, which, in this case, is “plot.png.” Additionally, you can specify the desired height and width of the saved plot, along with the units of measurement, such as inches.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggsave</span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"plot.png"</span>, <span class="co"># Name the file</span></span>
<span>       plot <span class="op">=</span> <span class="va">p_tufte</span>, <span class="co"># Name of the plot object in R</span></span>
<span>       height <span class="op">=</span> <span class="fl">8.5</span>, <span class="co"># Provide the desired dimensions</span></span>
<span>       width <span class="op">=</span> <span class="fl">11</span>, </span>
<span>       units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./manip.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data manipulation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./linear.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Basic linear model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">This tutorial was written by Edgar Vismara and Frederico Vieira.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This material was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>