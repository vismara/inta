<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Edgar Vismara and Frederico Vieira">

<title>Analysis of the behavior of dairy cattle using R - 4&nbsp; Data manipulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./visual.html" rel="next">
<link href="./basics.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Introduction to R</a></li><li class="breadcrumb-item"><a href="./manip.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data manipulation</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analysis of the behavior of dairy cattle using R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./start.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manip.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Statistical Modeling of Dairy Cattle Behavior</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#basic-data-manipulation-with-dplyr" id="toc-basic-data-manipulation-with-dplyr" class="nav-link active" data-scroll-target="#basic-data-manipulation-with-dplyr"><span class="header-section-number">4.1</span> Basic Data Manipulation with dplyr</a>
  <ul class="collapse">
  <li><a href="#mutate---adding-or-modifying-variables" id="toc-mutate---adding-or-modifying-variables" class="nav-link" data-scroll-target="#mutate---adding-or-modifying-variables"><code>mutate()</code> - Adding or Modifying Variables</a></li>
  <li><a href="#summarize---calculating-summary-statistics" id="toc-summarize---calculating-summary-statistics" class="nav-link" data-scroll-target="#summarize---calculating-summary-statistics"><code>summarize()</code> - Calculating Summary Statistics</a></li>
  <li><a href="#group_by---grouping-data" id="toc-group_by---grouping-data" class="nav-link" data-scroll-target="#group_by---grouping-data"><code>group_by()</code> - Grouping Data</a></li>
  <li><a href="#filter---filtering-rows" id="toc-filter---filtering-rows" class="nav-link" data-scroll-target="#filter---filtering-rows"><code>filter()</code> - Filtering Rows</a></li>
  <li><a href="#select---selecting-columns" id="toc-select---selecting-columns" class="nav-link" data-scroll-target="#select---selecting-columns"><code>select()</code> - Selecting Columns</a></li>
  <li><a href="#arrange---sorting-data" id="toc-arrange---sorting-data" class="nav-link" data-scroll-target="#arrange---sorting-data"><span class="header-section-number">4.1.1</span> <code>arrange()</code> - Sorting Data</a></li>
  </ul></li>
  <li><a href="#extended-data-manipulation-with-dplyr" id="toc-extended-data-manipulation-with-dplyr" class="nav-link" data-scroll-target="#extended-data-manipulation-with-dplyr"><span class="header-section-number">4.2</span> Extended Data Manipulation with dplyr</a>
  <ul class="collapse">
  <li><a href="#join---combining-datasets" id="toc-join---combining-datasets" class="nav-link" data-scroll-target="#join---combining-datasets"><code>join()</code> - Combining datasets</a></li>
  <li><a href="#advanced-filtering-with-between" id="toc-advanced-filtering-with-between" class="nav-link" data-scroll-target="#advanced-filtering-with-between">Advanced Filtering with <code>between()</code></a></li>
  <li><a href="#case_when---conditional-transformations-filtered_data" id="toc-case_when---conditional-transformations-filtered_data" class="nav-link" data-scroll-target="#case_when---conditional-transformations-filtered_data"><code>case_when()</code> - Conditional transformations filtered_data</a></li>
  <li><a href="#mutate_at---applying-functions-to-multiple-columns." id="toc-mutate_at---applying-functions-to-multiple-columns." class="nav-link" data-scroll-target="#mutate_at---applying-functions-to-multiple-columns."><code>mutate_at()</code> - Applying functions to multiple columns.</a></li>
  <li><a href="#group_by-with-multiple-variables---multi-level-grouping" id="toc-group_by-with-multiple-variables---multi-level-grouping" class="nav-link" data-scroll-target="#group_by-with-multiple-variables---multi-level-grouping"><code>group_by()</code> with multiple variables - Multi-level grouping</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">4.3</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#exercise-1-filtering-and-selecting" id="toc-exercise-1-filtering-and-selecting" class="nav-link" data-scroll-target="#exercise-1-filtering-and-selecting">Exercise 1: Filtering and Selecting</a></li>
  <li><a href="#exercise-2-grouping-and-summarizing" id="toc-exercise-2-grouping-and-summarizing" class="nav-link" data-scroll-target="#exercise-2-grouping-and-summarizing">Exercise 2: Grouping and Summarizing</a></li>
  <li><a href="#exercise-3-calculating-new-variables" id="toc-exercise-3-calculating-new-variables" class="nav-link" data-scroll-target="#exercise-3-calculating-new-variables">Exercise 3: Calculating New Variables</a></li>
  <li><a href="#exercise-4-filter-and-sorting-data" id="toc-exercise-4-filter-and-sorting-data" class="nav-link" data-scroll-target="#exercise-4-filter-and-sorting-data">Exercise 4: Filter and sorting Data</a></li>
  <li><a href="#exercise-5-preparing-data-for-ggplot2-visualization" id="toc-exercise-5-preparing-data-for-ggplot2-visualization" class="nav-link" data-scroll-target="#exercise-5-preparing-data-for-ggplot2-visualization">Exercise 5: Preparing Data for <code>ggplot2</code> Visualization</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data manipulation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this section, we will explore data manipulation techniques using the tidyverse package in R. We will work with a dataset previously imported from the web, specifically the <code>state_milk_production.csv</code>. The dataset describes milk production across different states in the United States along the last 53 years.</p>
<p>You can access the original data <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-01-29">here</a>. The dataset contains the following variables:</p>
<table class="table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Class</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>region</td>
<td>character</td>
<td>Region of the US</td>
</tr>
<tr class="even">
<td>state</td>
<td>character</td>
<td>US State</td>
</tr>
<tr class="odd">
<td>year</td>
<td>date</td>
<td>Year</td>
</tr>
<tr class="even">
<td>milk_produced</td>
<td>double</td>
<td>Pounds of Milk Produced</td>
</tr>
</tbody>
</table>
<hr>
<section id="basic-data-manipulation-with-dplyr" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="basic-data-manipulation-with-dplyr"><span class="header-section-number">4.1</span> Basic Data Manipulation with dplyr</h2>
<p>We’ll cover the fundamental data manipulation functions provided by the <code>dplyr</code> package in R such as: <code>mutate()</code> for adding or modifying variables, <code>summarize()</code> for calculating summary statistics ,<code>group_by()</code> and <code>ungroup()</code> for grouping and ungrouping data,<code>filter()</code> fro filtering rows, <code>select()</code> for selecting columns and <code>arrange()</code> for sorting data.</p>
<hr>
<section id="mutate---adding-or-modifying-variables" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mutate---adding-or-modifying-variables"><code>mutate()</code> - Adding or Modifying Variables</h3>
<p>The <code>mutate()</code> function is used to create new variables or modify existing ones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a new variable: milk_per_cow_kg</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mutated_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">milk_produced_kg =</span> milk_produced <span class="sc">*</span> <span class="fl">0.453592</span>)  <span class="co"># Convert pounds to kilograms</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mutated_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,400 × 5
   region    state          year milk_produced milk_produced_kg
   &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;
 1 Northeast Maine          1970     619000000        280773448
 2 Northeast New Hampshire  1970     356000000        161478752
 3 Northeast Vermont        1970    1970000000        893576240
 4 Northeast Massachusetts  1970     658000000        298463536
 5 Northeast Rhode Island   1970      75000000         34019400
 6 Northeast Connecticut    1970     661000000        299824312
 7 Northeast New York       1970   10341000000       4690594872
 8 Northeast New Jersey     1970     730000000        331122160
 9 Northeast Pennsylvania   1970    7124000000       3231389408
10 Northeast Delaware       1970     130000000         58966960
# ℹ 2,390 more rows</code></pre>
</div>
</div>
<hr>
</section>
<section id="summarize---calculating-summary-statistics" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="summarize---calculating-summary-statistics"><code>summarize()</code> - Calculating Summary Statistics</h3>
<p>The <code>summarize()</code> function calculates summary statistics for a specific group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total milk produced for each state</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_milk_produced =</span> <span class="fu">sum</span>(milk_produced))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 2
   state       total_milk_produced
   &lt;chr&gt;                     &lt;dbl&gt;
 1 Alabama             20764000000
 2 Alaska                675000000
 3 Arizona            116937000000
 4 Arkansas            26070000000
 5 California        1219691000000
 6 Colorado            86232000000
 7 Connecticut         24574000000
 8 Delaware             6094000000
 9 Florida            106660000000
10 Georgia             67745000000
# ℹ 40 more rows</code></pre>
</div>
</div>
<hr>
</section>
<section id="group_by---grouping-data" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="group_by---grouping-data"><code>group_by()</code> - Grouping Data</h3>
<p>The <code>group_by()</code> function is used to group data by a specific variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group data by year and calculate the average milk produced</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_milk_produced =</span> <span class="fu">mean</span>(milk_produced))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(grouped_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 2
    year avg_milk_produced
   &lt;dbl&gt;             &lt;dbl&gt;
 1  1970        2340140000
 2  1971        2371320000
 3  1972        2400500000
 4  1973        2309820000
 5  1974        2311720000
 6  1975        2307960000
 7  1976        2403600000
 8  1977        2453080000
 9  1978        2429220000
10  1979        2467020000
# ℹ 38 more rows</code></pre>
</div>
</div>
<hr>
</section>
<section id="filter---filtering-rows" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="filter---filtering-rows"><code>filter()</code> - Filtering Rows</h3>
<p>The <code>filter()</code> function is used to filter rows based on a condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the year 2022</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(filtered_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 4
# ℹ 4 variables: region &lt;chr&gt;, state &lt;chr&gt;, year &lt;dbl&gt;, milk_produced &lt;dbl&gt;</code></pre>
</div>
</div>
<hr>
</section>
<section id="select---selecting-columns" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="select---selecting-columns"><code>select()</code> - Selecting Columns</h3>
<p>The <code>select()</code> function is used to select specific columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only the "state" and "milk_produced" columns</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, milk_produced)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(selected_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,400 × 2
   state         milk_produced
   &lt;chr&gt;                 &lt;dbl&gt;
 1 Maine             619000000
 2 New Hampshire     356000000
 3 Vermont          1970000000
 4 Massachusetts     658000000
 5 Rhode Island       75000000
 6 Connecticut       661000000
 7 New York        10341000000
 8 New Jersey        730000000
 9 Pennsylvania     7124000000
10 Delaware          130000000
# ℹ 2,390 more rows</code></pre>
</div>
</div>
<hr>
</section>
<section id="arrange---sorting-data" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="arrange---sorting-data"><span class="header-section-number">4.1.1</span> <code>arrange()</code> - Sorting Data</h3>
<p>The <code>arrange()</code> function is used to sort data by one or more variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange data by year in descending order</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sorted_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(year))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sorted_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,400 × 4
   region    state          year milk_produced
   &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;
 1 Northeast Maine          2017     630000000
 2 Northeast New Hampshire  2017     273000000
 3 Northeast Vermont        2017    2728000000
 4 Northeast Massachusetts  2017     211000000
 5 Northeast Rhode Island   2017      13000000
 6 Northeast Connecticut    2017     420000000
 7 Northeast New York       2017   14912000000
 8 Northeast New Jersey     2017     119000000
 9 Northeast Pennsylvania   2017   10938000000
10 Northeast Delaware       2017      93000000
# ℹ 2,390 more rows</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="extended-data-manipulation-with-dplyr" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="extended-data-manipulation-with-dplyr"><span class="header-section-number">4.2</span> Extended Data Manipulation with dplyr</h2>
<p>In order to demonstrate advanced data manipulation with the <code>dplyr</code> package, we’ll begin by importing another dataset from the United States Department of Agriculture (USDA), known as the ‘milkcow_facts.csv’ dataset.</p>
<p>You can access the original data <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-01-29">here</a>. The dataset contains the following variables:</p>
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 20%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Class</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>year</td>
<td>date</td>
<td>Year</td>
</tr>
<tr class="even">
<td>avg_milk_cow_number</td>
<td>double</td>
<td>Average number of milk cows</td>
</tr>
<tr class="odd">
<td>milk_per_cow</td>
<td>double</td>
<td>Average milk production per cow in pounds</td>
</tr>
<tr class="even">
<td>milk_production_lbs</td>
<td>double</td>
<td>Total milk production in pounds</td>
</tr>
<tr class="odd">
<td>avg_price_milk</td>
<td>double</td>
<td>Average price paid for milk (dollars per pound)</td>
</tr>
<tr class="even">
<td>dairy_ration</td>
<td>double</td>
<td>Average price paid for dairy cow rations (dollars per pound)</td>
</tr>
<tr class="odd">
<td>milk_feed_price_ratio</td>
<td>double</td>
<td>Ratio of average price of milk per dairy cow ration</td>
</tr>
<tr class="even">
<td>milk_cow_cost_per_animal</td>
<td>double</td>
<td>Average cost of a milk cow per animal (dollars)</td>
</tr>
<tr class="odd">
<td>milk_volume_to_buy_cow_in_lbs</td>
<td>double</td>
<td>Milk volume required to purchase a cow (pounds)</td>
</tr>
<tr class="even">
<td>alfalfa_hay_price</td>
<td>double</td>
<td>Alfalfa hay price received by farmers (tons)</td>
</tr>
<tr class="odd">
<td>slaughter_cow_price</td>
<td>double</td>
<td>Slaughter cow price (value of meat in dollars per pound)</td>
</tr>
</tbody>
</table>
<p>The subsequent code imports data using the method previously introduced in the preceding chapter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the URL of the dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>data_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-29/milkcow_facts.csv"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data from the internet</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>milk_cow_facts <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(data_url, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="join---combining-datasets" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="join---combining-datasets"><code>join()</code> - Combining datasets</h3>
<p>The <code>join()</code> function is used to combine multiple datasets based on common keys, allowing you to create more complex datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining two datasets based on a common variable (e.g., year)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> milk_cow_facts <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(grouped_data, <span class="at">by =</span> <span class="st">"year"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 12
    year avg_milk_cow_number milk_per_cow milk_production_lbs avg_price_milk
   &lt;dbl&gt;               &lt;dbl&gt;        &lt;dbl&gt;               &lt;dbl&gt;          &lt;dbl&gt;
 1  1980            10799000        11891        128406000000          0.13 
 2  1981            10898000        12183        132770000000          0.138
 3  1982            11011000        12306        135505000000          0.136
 4  1983            11059000        12622        139588000000          0.136
 5  1984            10793000        12541        135351000000          0.135
 6  1985            10981000        13024        143012000000          0.127
 7  1986            10773000        13285        143124000000          0.125
 8  1987            10327000        13819        142709000000          0.125
 9  1988            10224000        14185        145034000000          0.122
10  1989            10046000        14323        143893000000          0.136
# ℹ 25 more rows
# ℹ 7 more variables: dairy_ration &lt;dbl&gt;, milk_feed_price_ratio &lt;dbl&gt;,
#   milk_cow_cost_per_animal &lt;dbl&gt;, milk_volume_to_buy_cow_in_lbs &lt;dbl&gt;,
#   alfalfa_hay_price &lt;dbl&gt;, slaughter_cow_price &lt;dbl&gt;, avg_milk_produced &lt;dbl&gt;</code></pre>
</div>
</div>
<hr>
</section>
<section id="advanced-filtering-with-between" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="advanced-filtering-with-between">Advanced Filtering with <code>between()</code></h3>
<p>In data analysis, advanced filtering often requires the ability to select rows based on specific numeric ranges. The <code>between()</code> function in R is a powerful tool that enables advanced filtering by allowing you to extract rows where a variable falls within a defined range. Let’s explore how to use this function for more complex filtering tasks. For instance, suppose you want to perform advanced filtering to select rows with years falling within the range of 2015 to 2020:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced filtering: Select data for a specific range of years</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(year, <span class="dv">2015</span>, <span class="dv">2020</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(filtered_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 4
   region    state          year milk_produced
   &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;
 1 Northeast Maine          2015     594000000
 2 Northeast New Hampshire  2015     282000000
 3 Northeast Vermont        2015    2666000000
 4 Northeast Massachusetts  2015     217000000
 5 Northeast Rhode Island   2015      16000000
 6 Northeast Connecticut    2015     396000000
 7 Northeast New York       2015   14094000000
 8 Northeast New Jersey     2015     127000000
 9 Northeast Pennsylvania   2015   10800000000
10 Northeast Delaware       2015      99000000
# ℹ 140 more rows</code></pre>
</div>
</div>
<hr>
</section>
<section id="case_when---conditional-transformations-filtered_data" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="case_when---conditional-transformations-filtered_data"><code>case_when()</code> - Conditional transformations filtered_data</h3>
<p>The <code>case_when()</code> function is used to perform conditional transformations, allowing you to create new variables based on multiple conditions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new variable "milk_prod" based on conditions</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>transformed_data <span class="ot">&lt;-</span> milk_cow_facts <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">milk_prod =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    milk_per_cow <span class="sc">&gt;</span> <span class="dv">19000</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    milk_per_cow <span class="sc">&gt;</span> <span class="dv">14000</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Low"</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(transformed_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 12
    year avg_milk_cow_number milk_per_cow milk_production_lbs avg_price_milk
   &lt;dbl&gt;               &lt;dbl&gt;        &lt;dbl&gt;               &lt;dbl&gt;          &lt;dbl&gt;
 1  1980            10799000        11891        128406000000          0.13 
 2  1981            10898000        12183        132770000000          0.138
 3  1982            11011000        12306        135505000000          0.136
 4  1983            11059000        12622        139588000000          0.136
 5  1984            10793000        12541        135351000000          0.135
 6  1985            10981000        13024        143012000000          0.127
 7  1986            10773000        13285        143124000000          0.125
 8  1987            10327000        13819        142709000000          0.125
 9  1988            10224000        14185        145034000000          0.122
10  1989            10046000        14323        143893000000          0.136
# ℹ 25 more rows
# ℹ 7 more variables: dairy_ration &lt;dbl&gt;, milk_feed_price_ratio &lt;dbl&gt;,
#   milk_cow_cost_per_animal &lt;dbl&gt;, milk_volume_to_buy_cow_in_lbs &lt;dbl&gt;,
#   alfalfa_hay_price &lt;dbl&gt;, slaughter_cow_price &lt;dbl&gt;, milk_prod &lt;chr&gt;</code></pre>
</div>
</div>
<hr>
</section>
<section id="mutate_at---applying-functions-to-multiple-columns." class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mutate_at---applying-functions-to-multiple-columns."><code>mutate_at()</code> - Applying functions to multiple columns.</h3>
<p>The <code>mutate_at()</code> function allows you to apply a function to multiple columns simultaneously.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the transformation to selected columns</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>transformed_data <span class="ot">&lt;-</span> milk_cow_facts <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(milk_production_lbs, milk_per_cow), <span class="cf">function</span>(x) x <span class="sc">*</span> <span class="fl">0.453592</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(transformed_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 11
    year avg_milk_cow_number milk_per_cow milk_production_lbs avg_price_milk
   &lt;dbl&gt;               &lt;dbl&gt;        &lt;dbl&gt;               &lt;dbl&gt;          &lt;dbl&gt;
 1  1980            10799000        5394.         58243934352          0.13 
 2  1981            10898000        5526.         60223409840          0.138
 3  1982            11011000        5582.         61463983960          0.136
 4  1983            11059000        5725.         63316000096          0.136
 5  1984            10793000        5688.         61394130792          0.135
 6  1985            10981000        5908.         64869099104          0.127
 7  1986            10773000        6026.         64919901408          0.125
 8  1987            10327000        6268.         64731660728          0.125
 9  1988            10224000        6434.         65786262128          0.122
10  1989            10046000        6497.         65268713656          0.136
# ℹ 25 more rows
# ℹ 6 more variables: dairy_ration &lt;dbl&gt;, milk_feed_price_ratio &lt;dbl&gt;,
#   milk_cow_cost_per_animal &lt;dbl&gt;, milk_volume_to_buy_cow_in_lbs &lt;dbl&gt;,
#   alfalfa_hay_price &lt;dbl&gt;, slaughter_cow_price &lt;dbl&gt;</code></pre>
</div>
</div>
<hr>
</section>
<section id="group_by-with-multiple-variables---multi-level-grouping" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="group_by-with-multiple-variables---multi-level-grouping"><code>group_by()</code> with multiple variables - Multi-level grouping</h3>
<p>You can use <code>group_by()</code> with multiple variables to create multi-level grouping for more complex summaries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group data by region and year and calculate summary statistics</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>multi_level_grouped_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region, year) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_milk_produced =</span> <span class="fu">sum</span>(milk_produced))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(multi_level_grouped_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 480 × 3
# Groups:   region [10]
   region       year total_milk_produced
   &lt;chr&gt;       &lt;dbl&gt;               &lt;dbl&gt;
 1 Appalachian  1970          8202000000
 2 Appalachian  1971          8216000000
 3 Appalachian  1972          8389000000
 4 Appalachian  1973          7900000000
 5 Appalachian  1974          7858000000
 6 Appalachian  1975          7953000000
 7 Appalachian  1976          8292000000
 8 Appalachian  1977          8434000000
 9 Appalachian  1978          8109000000
10 Appalachian  1979          8163000000
# ℹ 470 more rows</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="exercises" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="exercises"><span class="header-section-number">4.3</span> Exercises</h2>
<section id="exercise-1-filtering-and-selecting" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="exercise-1-filtering-and-selecting">Exercise 1: Filtering and Selecting</h3>
<p>Filter the <code>milk_cow_facts</code> dataset to retain only rows for the year 2015. Then, select and display the total milk production in pounds (<code>milk_produced</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 1: Filtering and Selecting</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, milk_produced)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>filtered_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 2
   state         milk_produced
   &lt;chr&gt;                 &lt;dbl&gt;
 1 Maine             594000000
 2 New Hampshire     282000000
 3 Vermont          2666000000
 4 Massachusetts     217000000
 5 Rhode Island       16000000
 6 Connecticut       396000000
 7 New York        14094000000
 8 New Jersey        127000000
 9 Pennsylvania    10800000000
10 Delaware           99000000
# ℹ 40 more rows</code></pre>
</div>
</div>
<hr>
</section>
<section id="exercise-2-grouping-and-summarizing" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="exercise-2-grouping-and-summarizing">Exercise 2: Grouping and Summarizing</h3>
<p>Group the <code>milkcow_facts</code> dataset by the <code>year</code> variable. Calculate the average milk production per cow (<code>milk_per_cow</code>) for each year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 2: Grouping and Summarizing</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> milk_cow_facts <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_milk_per_cow =</span> <span class="fu">mean</span>(milk_per_cow, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>summary_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 2
    year avg_milk_per_cow
   &lt;dbl&gt;            &lt;dbl&gt;
 1  1980            11891
 2  1981            12183
 3  1982            12306
 4  1983            12622
 5  1984            12541
 6  1985            13024
 7  1986            13285
 8  1987            13819
 9  1988            14185
10  1989            14323
# ℹ 25 more rows</code></pre>
</div>
</div>
<hr>
</section>
<section id="exercise-3-calculating-new-variables" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="exercise-3-calculating-new-variables">Exercise 3: Calculating New Variables</h3>
<p>In the <code>milk_cow_facts</code> dataset, calculate the ratio of the average price of milk per dairy cow ration (<code>milk_feed_price_ratio</code>) by dividing the average price paid for milk (<code>avg_price_milk</code>) by the average price paid for dairy cow rations (<code>dairy_ration</code>) in 2013.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 3: Calculating New Variables and filtering</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>milkcow_facts_2013 <span class="ot">&lt;-</span> milk_cow_facts <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2013</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">milk_feed_price_ratio =</span> avg_price_milk <span class="sc">/</span> dairy_ration)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>milkcow_facts_2013</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 11
   year avg_milk_cow_number milk_per_cow milk_production_lbs avg_price_milk
  &lt;dbl&gt;               &lt;dbl&gt;        &lt;dbl&gt;               &lt;dbl&gt;          &lt;dbl&gt;
1  2013             9224000        21816        201231000000          0.201
# ℹ 6 more variables: dairy_ration &lt;dbl&gt;, milk_feed_price_ratio &lt;dbl&gt;,
#   milk_cow_cost_per_animal &lt;dbl&gt;, milk_volume_to_buy_cow_in_lbs &lt;dbl&gt;,
#   alfalfa_hay_price &lt;dbl&gt;, slaughter_cow_price &lt;dbl&gt;</code></pre>
</div>
</div>
<hr>
</section>
<section id="exercise-4-filter-and-sorting-data" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="exercise-4-filter-and-sorting-data">Exercise 4: Filter and sorting Data</h3>
<p>Sort the <code>state_milk_production</code> dataset in descending order based on the <code>milk_produced</code> variable in 2014. Display the top 10 states with the highest production of milk in this year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 4: Sorting Data</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>sorted_data <span class="ot">&lt;-</span> state_milk_production <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2014</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(milk_produced)) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>sorted_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   region          state         year milk_produced
   &lt;chr&gt;           &lt;chr&gt;        &lt;dbl&gt;         &lt;dbl&gt;
 1 Pacific         California    2014   42339000000
 2 Lake States     Wisconsin     2014   27795000000
 3 Mountain        Idaho         2014   13873000000
 4 Northeast       New York      2014   13730000000
 5 Northeast       Pennsylvania  2014   10664000000
 6 Southern Plains Texas         2014   10310000000
 7 Lake States     Michigan      2014    9609000000
 8 Lake States     Minnesota     2014    9127000000
 9 Mountain        New Mexico    2014    8105000000
10 Pacific         Washington    2014    6576000000</code></pre>
</div>
</div>
<hr>
</section>
<section id="exercise-5-preparing-data-for-ggplot2-visualization" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="exercise-5-preparing-data-for-ggplot2-visualization">Exercise 5: Preparing Data for <code>ggplot2</code> Visualization</h3>
<p>For our upcoming exercise, we will be working with another two datasets: <code>milk_products_facts</code> and <code>clean_cheese</code>. These datasets offer valuable insights into consumption patterns of various dairy and cheese products in the United States over the years.</p>
<p>To import the <code>milk_products_facts</code> dataset, use the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the URL of the dataset for milk products</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>milk_products_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-29/milk_products_facts.csv"</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data from the internet</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>milk_products_facts <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(milk_products_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To import the <code>clean_cheese</code> dataset, use the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the URL of the dataset for clean cheese products</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>clean_cheese_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-29/clean_cheese.csv"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data from the internet</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>clean_cheese <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(clean_cheese_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s a complete overview of the variables within each dataset:</p>
<p><strong>milk_products_facts:</strong></p>
<table class="table">
<colgroup>
<col style="width: 35%">
<col style="width: 9%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Class</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>year</td>
<td>date</td>
<td>Year</td>
</tr>
<tr class="even">
<td>fluid_milk</td>
<td>double</td>
<td>Average milk consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>fluid_yogurt</td>
<td>double</td>
<td>Average yogurt consumption in pounds per person</td>
</tr>
<tr class="even">
<td>butter</td>
<td>double</td>
<td>Average butter consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>cheese_american</td>
<td>double</td>
<td>Average American cheese consumption in pounds per person</td>
</tr>
<tr class="even">
<td>cheese_other</td>
<td>double</td>
<td>Average other cheese consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>cheese_cottage</td>
<td>double</td>
<td>Average cottage cheese consumption in pounds per person</td>
</tr>
<tr class="even">
<td>evap_cnd_canned_whole_milk</td>
<td>double</td>
<td>Average evaporated and canned whole milk consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>evap_cnd_bulk_whole_milk</td>
<td>double</td>
<td>Average evaporated and canned bulk whole milk consumption in pounds per person</td>
</tr>
<tr class="even">
<td>evap_cnd_bulk_and_can_skim_milk</td>
<td>double</td>
<td>Average evaporated and canned bulk and canned skim milk consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>frozen_ice_cream_regular</td>
<td>double</td>
<td>Average regular frozen ice cream consumption in pounds per person</td>
</tr>
<tr class="even">
<td>frozen_ice_cream_reduced_fat</td>
<td>double</td>
<td>Average reduced-fat frozen ice cream consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>frozen_sherbet</td>
<td>double</td>
<td>Average frozen sherbet consumption in pounds per person</td>
</tr>
<tr class="even">
<td>frozen_other</td>
<td>double</td>
<td>Average consumption of other frozen milk products in pounds per person</td>
</tr>
<tr class="odd">
<td>dry_whole_milk</td>
<td>double</td>
<td>Average consumption of dry whole milk in pounds per person</td>
</tr>
<tr class="even">
<td>dry_nonfat_milk</td>
<td>double</td>
<td>Average consumption of dry nonfat milk in pounds per person</td>
</tr>
<tr class="odd">
<td>dry_buttermilk</td>
<td>double</td>
<td>Average consumption of dry buttermilk in pounds per person</td>
</tr>
<tr class="even">
<td>dry_whey</td>
<td>double</td>
<td>Average consumption of dry whey (milk protein) in pounds per person</td>
</tr>
</tbody>
</table>
<p><strong>clean_cheese:</strong></p>
<table class="table">
<colgroup>
<col style="width: 35%">
<col style="width: 9%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Class</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Year</td>
<td>date</td>
<td>Year</td>
</tr>
<tr class="even">
<td>Cheddar</td>
<td>double</td>
<td>Cheddar consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>American Other</td>
<td>double</td>
<td>American Other consumption in pounds per person</td>
</tr>
<tr class="even">
<td>Mozzarella</td>
<td>double</td>
<td>Mozzarella consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>Italian Other</td>
<td>double</td>
<td>Italian Other consumption in pounds per person</td>
</tr>
<tr class="even">
<td>Swiss</td>
<td>double</td>
<td>Swiss consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>Brick</td>
<td>double</td>
<td>Brick consumption in pounds per person</td>
</tr>
<tr class="even">
<td>Muenster</td>
<td>double</td>
<td>Muenster consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>Cream and Neufchatel</td>
<td>double</td>
<td>Cream and Neufchatel consumption in pounds per person</td>
</tr>
<tr class="even">
<td>Blue</td>
<td>double</td>
<td>Blue consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>Other Dairy Cheese</td>
<td>double</td>
<td>Other Dairy Cheese consumption in pounds per person</td>
</tr>
<tr class="even">
<td>Processed Cheese</td>
<td>double</td>
<td>Processed Cheese consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>Foods and spreads</td>
<td>double</td>
<td>Foods and spreads consumption in pounds per person</td>
</tr>
<tr class="even">
<td>Total American Cheese</td>
<td>double</td>
<td>Total American Cheese consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>Total Italian Cheese</td>
<td>double</td>
<td>Total Italian Cheese consumption in pounds per person</td>
</tr>
<tr class="even">
<td>Total Natural Cheese</td>
<td>double</td>
<td>Total Natural Cheese consumption in pounds per person</td>
</tr>
<tr class="odd">
<td>Total Processed Cheese Products</td>
<td>double</td>
<td>Total Processed Cheese Products consumption in pounds per person</td>
</tr>
</tbody>
</table>
<p>These two datasets, like the previous ones, are also sourced from the same GitHub repository metioned before.</p>
<p><strong>Question</strong></p>
<p>In this exercise, we will analyze and visualize the trends in cheese consumption in the United States. Specifically, we aim to understand the relationship between the consumption of American cheese and mozzarella cheese over the years.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li><p>Select relevant variables from each dataset. From “milk_products_facts,” select “year” and “cheese_american.” From “clean_cheese,” select “Year” and “Mozzarella.”</p></li>
<li><p>Merge the datasets using a common variable, which is “year.”</p></li>
<li><p>Calculate the ratio of American cheese consumption to mozzarella consumption for each year.</p></li>
<li><p>Create a line plot using the <code>ggplot2</code> package to visualize how the ratio of American cheese consumption to mozzarella consumption has changed over the years.</p></li>
</ol>
<p><strong>Answer:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform data manipulation</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>milk_products_facts <span class="ot">&lt;-</span> milk_products_facts <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, cheese_american) </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>clean_cheese <span class="ot">&lt;-</span> clean_cheese <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Mozzarella) </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the datasets on the "year" variable</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(milk_products_facts, clean_cheese, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"year"</span> <span class="ot">=</span> <span class="st">"Year"</span>))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the ratio of American cheese consumption to mozzarella consumption</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ratio =</span> cheese_american <span class="sc">/</span> Mozzarella)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a line plot</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> ratio)) <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ratio (American Cheese / Mozzarella)"</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ratio of American Cheese to Mozzarella Consumption Over the Years"</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="manip_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./basics.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./visual.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">This tutorial was written by Edgar Vismara and Frederico Vieira.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This material was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>